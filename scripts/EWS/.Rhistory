library(bfast)
library(zoo)
# #           Manaus
# #-------------------------------
# ################################
#
# #-------------------------------
# #        regular climate
# #-------------------------------
#
# # !!!!! note this is the monthly integrated data frame!!!!!!!
# df_regclim <- read.csv("/home/amazonfaceme/biancarius/CAETE-DVM-alloc-allom/outputs/MAN/experiments/MAN_regularclimate/gridcell186-239/MAN_regularclimate_monthly.csv")
df_regclim <- read.csv("/home/bianca/bianca/CAETE-DVM-alloc-allom/scripts/monthly_mean_tables/MAN_regularclimate_monthly.csv")
# Criando objetos de série temporal para todas as colunas
time_series_list_regclim <- lapply(df_regclim[, -1], function(col) {
ts(col, start = c(1979, 1), frequency = 12)
})
# Atribuindo nomes às séries temporais
names(time_series_list_regclim) <- names(df_regclim[, -1])
# Executar bfast
# Executar bfast e plotar resultados
columns_to_process <- c("npp", "photo", "cleaf", "croot", "cwood", "cheart", "csap", "csto", "evapm", "ar")
for (col_name in columns_to_process) {
res_bfast_regclim <- bfast(time_series_list_regclim[[col_name]],
h = 0.25, max.iter = 1)
plot(res_bfast_regclim, main = col_name)
}
res_bfast_regclim
for (col_name in columns_to_process) {
res_bfast_regclim <- bfast(time_series_list_regclim[[col_name]],
h = 0.25, max.iter = 1)
res_bfast_regclim
plot(res_bfast_regclim, main = col_name)
}
for (col_name in columns_to_process) {
res_bfast_regclim <- bfast(time_series_list_regclim[[col_name]],
h = 0.25, max.iter = 1)
print(res_bfast_regclim)
plot(res_bfast_regclim, main = col_name)
}
bfast_res_list_regclim[[col_name]] <- res_bfast_regclim
bfast_res_list_regclim <- list()
# Executar bfast
# Executar bfast e plotar resultados
columns_to_process <- c("npp", "photo", "cleaf", "croot", "cwood", "cheart", "csap", "csto", "evapm", "ar")
for (col_name in columns_to_process) {
res_bfast_regclim <- bfast(time_series_list_regclim[[col_name]],
h = 0.25, max.iter = 1)
bfast_res_list_regclim[[col_name]] <- res_bfast_regclim
print(res_bfast_regclim)
plot(res_bfast_regclim, main = col_name)
}
bfast_res_list_regclim
# #    30% prec reduction
# #-------------------------------
# #-------------------------------
#
# #-------------------------------
# #           1y freq
# #-------------------------------
#
# # Manaus - 30% prec reduction - 1 year frequency application
# # !!!!! note this is the monthly integrated data frame!!!!!!!
df_1y <- read.csv("/home/bianca/bianca/CAETE-DVM-alloc-allom/scripts/monthly_mean_tables/MAN_30prec_1y_monthly.csv")
# Criando objetos de série temporal para todas as colunas
time_series_list_1y <- lapply(df_1y[, -1], function(col) {
ts(col, start = c(1979, 1), frequency = 12)
})
# #    30% prec reduction
# #-------------------------------
# #-------------------------------
#
# #-------------------------------
# #           1y freq
# #-------------------------------
#
# # Manaus - 30% prec reduction - 1 year frequency application
# # !!!!! note this is the monthly integrated data frame!!!!!!!
df_1y <- read.csv("/home/bianca/bianca/CAETE-DVM-alloc-allom/scripts/monthly_mean_tables/MAN_30prec_1y_monthly.csv")
# Criando objetos de série temporal para todas as colunas
time_series_list_1y <- lapply(df_1y[, -1], function(col) {
ts(col, start = c(1979, 1), frequency = 12)
})
# Atribuindo nomes às séries temporais
names(time_series_list_1y) <- names(df_1y[, -1])
bfast_res_list_1y <- list()
# Executar bfast
# Executar bfast e plotar resultados
columns_to_process <- c("npp", "photo", "cleaf", "croot", "cwood", "cheart", "csap", "csto", "evapm", "ar")
for (col_name in columns_to_process) {
res_bfast_1y <- bfast(time_series_list_1y[[col_name]],
h = 0.25, max.iter = 1)
bfast_res_list_1y[[col_name]] <- res_bfast_1y
plot(res_bfast_1y, main = col_name)
}
bfast_res_list_1y
bfast_res_list_1y$croot
bfast_res_list_1y$cwood
bfast_res_list_1y$cheart
bfast_res_list_1y$csap
bfast_res_list_1y$csto
bfast_res_list_1y$evapm
bfast_res_list_1y$ar
bfast_res_list_3y <- list()
# plot(res_bfast, main = "NPP\n-30% prec  1year freq", ylab = "NPP", xlab = "Time")
# # dev.off()
#
# #-------------------------------
# #           3y freq
# #-------------------------------
#
# # Manaus - 30% prec reduction - 3 year frequency application
# # !!!!! note this is the monthly integrated data frame!!!!!!!
# df_3y <- read.csv("/home/amazonfaceme/biancarius/CAETE-DVM-alloc-allom/outputs/MAN/experiments/30perc_reduction/MAN_30prec_3y/gridcell186-239/MAN_30prec_3y_monthly.csv")
df_3y <- read.csv("/home/bianca/bianca/CAETE-DVM-alloc-allom/scripts/monthly_mean_tables/MAN_30prec_3y_monthly.csv")
# Criando objetos de série temporal para todas as colunas
time_series_list_3y <- lapply(df_3y[, -1], function(col) {
ts(col, start = c(1979, 1), frequency = 12)
})
# Atribuindo nomes às séries temporais
names(time_series_list_3y) <- names(df_3y[, -1])
bfast_res_list_3y <- list()
# Executar bfast
# Executar bfast e plotar resultados
columns_to_process <- c("npp", "photo", "cleaf", "croot", "cwood", "cheart", "csap", "csto", "evapm", "ar")
for (col_name in columns_to_process) {
res_bfast_3y <- bfast(time_series_list_3y[[col_name]],
h = 0.25, max.iter = 1)
bfast_res_list_3y[[col_name]] <- res_bfast_3y
plot(res_bfast_3y, main = col_name)
}
bfast_res_list_3y
bfast_res_list_3y$npp
bfast_res_list_3y$photo
bfast_res_list_3y$cleaf
bfast_res_list_3y$croot
bfast_res_list_3y$cwood
bfast_res_list_3y$cheart
bfast_res_list_3y$csap
bfast_res_list_3y$csto
bfast_res_list_3y$evapm
bfast_res_list_3y$ar
# # dev.off()
#
# #-------------------------------
# #           5y freq
# #-------------------------------
#
#
# # Manaus - 30% prec reduction - 3 year frequency application
# # !!!!! note this is the monthly integrated data frame!!!!!!!
# # df_5y <- read.csv("/home/amazonfaceme/biancarius/CAETE-DVM-alloc-allom/outputs/MAN/experiments/30perc_reduction/MAN_30prec_5y/gridcell186-239/MAN_30prec_5y_monthly.csv")
df_5y <- read.csv("/home/bianca/bianca/CAETE-DVM-alloc-allom/scripts/monthly_mean_tables/MAN_30prec_5y_monthly.csv")
# Criando objetos de série temporal para todas as colunas
time_series_list_5y <- lapply(df_5y[, -1], function(col) {
ts(col, start = c(1979, 1), frequency = 12)
})
# Atribuindo nomes às séries temporais
names(time_series_list_5y) <- names(df_5y[, -1])
bfast_res_list_5y <- list()
# Executar bfast
# Executar bfast e plotar resultados
columns_to_process <- c("npp", "photo", "cleaf", "croot", "cwood", "cheart", "csap", "csto", "evapm", "ar")
for (col_name in columns_to_process) {
res_bfast_5y <- bfast(time_series_list_5y[[col_name]],
h = 0.25, max.iter = 1)
bfast_res_list_5y[[col_name]] <- res_bfast_5y
plot(res_bfast_5y, main = col_name)
}
bfast_res_list_5y$npp
bfast_res_list_5y$photo
bfast_res_list_5y$cleaf
bfast_res_list_5y$croot
bfast_res_list_5y$cwood
bfast_res_list_5y$cheart
bfast_res_list_5y$csap
bfast_res_list_5y$csto
bfast_res_list_5y$evapm
bfast_res_list_5y$ar
# # dev.off()
#
# #-------------------------------
# #           7y freq
# #-------------------------------
#
#
# # Manaus - 30% prec reduction - 7 year frequency application
# # !!!!! note this is the monthly integrated data frame!!!!!!!
# # df_7y <- read.csv("/home/amazonfaceme/biancarius/CAETE-DVM-alloc-allom/outputs/MAN/experiments/30perc_reduction/MAN_30prec_7y/gridcell186-239/MAN_30prec_7y_monthly.csv")
df_7y <- read.csv("/home/bianca/bianca/CAETE-DVM-alloc-allom/scripts/monthly_mean_tables/MAN_30prec_7y_monthly.csv")
# Criando objetos de série temporal para todas as colunas
time_series_list_7y <- lapply(df_7y[, -1], function(col) {
ts(col, start = c(1979, 1), frequency = 12)
})
# Atribuindo nomes às séries temporais
names(time_series_list_7y) <- names(df_7y[, -1])
bfast_res_list_7y<- list()
# Executar bfast
# Executar bfast e plotar resultados
columns_to_process <- c("npp", "photo", "cleaf", "croot", "cwood", "cheart", "csap", "csto", "evapm", "ar")
for (col_name in columns_to_process) {
res_bfast_7y <- bfast(time_series_list_7y[[col_name]],
h = 0.25, max.iter = 1)
bfast_res_list_7y[[col_name]] <- res_bfast_7y
plot(res_bfast_7y, main = col_name)
}
bfast_res_list_7y
bfast_res_list_7y$npp
bfast_res_list_7y$photo
bfast_res_list_7y$cleaf
bfast_res_list_7y$croot
bfast_res_list_7y$cwood
bfast_res_list_7y$cheart
bfast_res_list_7y$csap
bfast_res_list_7y$csto
bfast_res_list_7y$evapm
bfast_res_list_7y$ar
